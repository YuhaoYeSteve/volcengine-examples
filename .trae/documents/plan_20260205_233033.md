# Ark Chat v2.0 产品升级规划

本规划旨在将 Ark Chat 从基础对话工具升级为具备富文本展示、多模态交互及个性化配置的完整 AI 助手。

## 1. 核心体验升级：富文本与代码高亮
**目标**：解决当前纯文本显示难以阅读代码和长文的问题。
- **技术实现**：
  - 引入 `marked.js` 用于 Markdown 渲染。
  - 引入 `highlight.js` 用于代码块语法高亮。
  - 引入 GitHub Markdown CSS 优化排版样式。
- **前端改动**：
  - 拦截消息输出，将原始内容转换为 HTML 后再注入 DOM。
  - 对生成的代码块添加“复制”按钮。
  - 优化输入框体验，支持随内容自动增高（Auto-resize）。

## 2. 能力增强：多模态识图支持
**目标**：整合项目现有的图片识别能力，允许用户在对话中发送图片。
- **后端 (`ark_server.py`)**：
  - 更新 `ChatRequest` 数据模型，支持接收图片数据（URL 或 Base64）。
  - 升级 `/api/chat` 接口，适配 Volcengine SDK 的多模态消息格式（`type: image_url`）。
- **前端 (`chat.html`)**：
  - 输入框增加“图片上传”按钮。
  - 支持 `Ctrl+V` 直接粘贴剪贴板图片。
  - 消息列表中预览用户发送的图片。

## 3. 个性化配置：设置面板
**目标**：允许用户定制 AI 行为，不再硬编码。
- **功能点**：
  - **System Prompt（人设）**：用户可定义“你是一个翻译官”或“Python 专家”。
  - **Endpoint ID 管理**：允许用户配置不同的模型接入点 ID（如区分 Lite/Pro 模型），并在对话时切换。
- **实现**：
  - 新增“设置”模态框（Modal）。
  - 配置持久化存储于 LocalStorage。
  - 发送请求时动态注入 System Prompt 和选中的 Model Endpoint。

## 实施路线图
1.  **Step 1 (UI)**: 引入 Markdown 和高亮库，重构前端消息渲染逻辑。
2.  **Step 2 (Backend)**: 改造后端 API 接口，支持多模态消息结构。
3.  **Step 3 (Frontend)**: 实现图片上传/粘贴交互，对接新后端接口。
4.  **Step 4 (Feature)**: 增加设置面板，支持 System Prompt 和 Endpoint 配置。
